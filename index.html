<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Digit Probability Dashboard</title>
  <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <script src="https://unpkg.com/babel-standalone@6/babel.min.js"></script>
  <style>
    body {
      margin: 0;
      font-family: Arial;
      background: #0f0f0f;
      color: white;
    }
    .box {
      background: #1b1b1b;
      padding: 10px;
      margin: 10px;
      border-radius: 6px;
    }
    select, button {
      background: #222;
      color: white;
      padding: 8px;
      border-radius: 4px;
      border: none;
    }
  </style>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useEffect } = React;

    function App() {
      const [market, setMarket] = useState("R_10");
      const [ticks, setTicks] = useState([]);

      useEffect(() => {
        let ws = new WebSocket("wss://ws.binaryws.com/websockets/v3?app_id=1089");
        ws.onopen = () => ws.send(JSON.stringify({ ticks: market }));
        ws.onmessage = msg => {
          const data = JSON.parse(msg.data);
          if (data.tick) {
            const digit = Number(data.tick.quote.toString().slice(-1));
            setTicks(prev => [...prev.slice(-29), digit]);
          }
        };
        return () => ws.close();
      }, [market]);

      const computePercentages = () => {
        const last15 = ticks.slice(-15);
        const even = last15.filter(d => d%2===0).length;
        const odd = last15.length - even;
        const under = last15.filter(d => d <= 4).length;
        const over = last15.length - under;
        return {
          evenPct: last15.length ? ((even/last15.length)*100).toFixed(1) : 0,
          oddPct: last15.length ? ((odd/last15.length)*100).toFixed(1) : 0,
          underPct: last15.length ? ((under/last15.length)*100).toFixed(1) : 0,
          overPct: last15.length ? ((over/last15.length)*100).toFixed(1) : 0
        };
      };

      const dominantDigit = () => {
        const last15 = ticks.slice(-15);
        const counts = Array(10).fill(0);
        last15.forEach(d => counts[d]++);
        const maxCount = Math.max(...counts);
        const digit = counts.indexOf(maxCount);
        return {digit, pct: last15.length ? ((maxCount/last15.length)*100).toFixed(1) : 0};
      };

      const recommend = () => {
        const dom = dominantDigit();
        if(dom.pct >= 30) return `ðŸ’¥ RECOMMEND DIGIT ${dom.digit} (High ${dom.pct}%)`;
        return `No strong recommendation`;
      };

      const {evenPct, oddPct, underPct, overPct} = computePercentages();

      return (
        <div style={{padding: 10}}>
          <h2>Digit Probability â€” DARK</h2>

          <div className="box">
            <label>Market: </label>
            <select value={market} onChange={e=>setMarket(e.target.value)}>
              <option>R_10</option>
              <option>R_25</option>
              <option>R_50</option>
              <option>R_75</option>
              <option>R_100</option>
            </select>
          </div>

          <div className="box">
            <h3>Last Digits (30 Ticks)</h3>
            <p>{ticks.join(" ")}</p>
          </div>

          <div className="box">
            <h3>Even / Odd Percentages</h3>
            <p>Even: {evenPct}% | Odd: {oddPct}%</p>
          </div>

          <div className="box">
            <h3>Under / Over (0-4 / 5-9) Percentages</h3>
            <p>Under: {underPct}% | Over: {overPct}%</p>
          </div>

          <div className="box">
            <h3>Matches / Differs Recommendation</h3>
            <p>{recommend()}</p>
          </div>
        </div>
      );
    }

    ReactDOM.createRoot(document.getElementById("root")).render(<App/>);
  </script>
</body>
</html>
